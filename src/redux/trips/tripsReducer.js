const thailand1 = {
  id: "-1h_NN3nqzI",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1490077476659-095159692ab5?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["thailand"],
  description: "Karaweik"
};
const thailand2 = {
  id: "m9BBVrPl87M",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1506781961370-37a89d6b3095?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["thailand"],
  description: null
};
const thailand3 = {
  id: "gsllxmVO4HQ",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1528181304800-259b08848526?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["thailand"],
  description: "Traveling on motorbike in norther thailand we came across these amazing sculptural temples and buildings."
};
const cambodia1 = {
  id: "JkI4_sMnlOg",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1540578453513-d029cbe11a00?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["cambodia"],
  description: "Rainy Khmer Mornings"
};
const cambodia2 = {
  id: "EY3tC81nFt0",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1566706546199-a93ba33ce9f7?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["cambodia"],
  description: "Angkor Wat, Krong Siem Reap, Cambodia, Buddhist temple,"
};
const malayasia1 = {
  id: "4GYkrk4gpBo",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1532442782935-dc7ee648a2a5?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["malaysia"],
  description: "Lost"
};
const malayasia2 = {
  id: "JCsmBJPHW-s",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/flagged/photo-1560505455-11cee7a131b0?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["malaysia"],
  description: null
};
const singapore1 = {
  id: "tPKufFNIZfs",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1505662695181-d4b60363d2a3?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["singapore"],
  description: "Marina Bay Skyline"
};
const singapore2 = {
  id: "C8gvt2LMX94",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1555947970-15e7a8a0bb73?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["singapore"],
  description: null
};
const singapore3 = {
  id: "8tOVv8W81ss",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1508754039285-f78290179120?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["singapore"],
  description: null
}
const asiaSETrip = {
  _id: "asiaSETrip",
  name: "Southeast Asia Trek Summer 2021",
  numberofdays: 4,
  days: [
    {
      name: "DAY 1",
      content: [
        cambodia1,
        cambodia2
      ]
    },
    {
      name: "DAY 2",
      content: [
        thailand1,
        thailand2,
        thailand3
      ]
    },
    {
      name: "DAY 3",
      content: [
        malayasia1,
        malayasia2
      ]
    },
    {
      name: "DAY 4",
      content: [
        singapore1,
        singapore2,
        singapore3
      ]
    }
  ]
};
const banff1 = {
  id: "oMneOBYhJxY",
  mediaType: 'media',
  urls: {
    small: "https://images.unsplash.com/photo-1503614472-8c93d56e92ce?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0MzAyN30"
  },
  tags: ["banff"],
  description: "Color of the lake is so beautiful!"
};
const banff2 = {
  id: "ORo9_nM0TlfmEte4iJwKPQ",
  mediaType: 'restaurant',
  photoUrl: "https://s3-media3.fl.yelpcdn.com/bphoto/9vRJ-N59zi9Y8HZiL_YNJg/o.jpg",
  tags: ["banff"],
  name : "Rocky Mountain Flatbread"
};
const banff3 = {
  id : "AF1QipMtHQTSD_DQG8C-iXITpLPDh12BUHlB33KsMMuP=s1600-h500",
  name : "Canmore Museum and Geoscience Centre",
  photoUrl : "https://lh3.googleusercontent.com/p/AF1QipMtHQTSD_DQG8C-iXITpLPDh12BUHlB33KsMMuP=s1600-h500",
  tags : [
    "banff"
  ],
  mediaType : "place"
};
const banff4 = {
  id : "AF1QipP5KHMymqvr-SPZnfv26XD9uZoDSPrK2WR7Jf7i=s1600-h500",
  name : "Giant Steps Waterfall",
  photoUrl : "https://lh3.googleusercontent.com/p/AF1QipP5KHMymqvr-SPZnfv26XD9uZoDSPrK2WR7Jf7i=s1600-h500",
  tags : [
    "banff"
  ],
  mediaType : "place"
};
const banffTrip = {
  _id: "banffTrip",
  name: "Banff Trip June 2021",
  numberofdays: 2,
  days: [
    {
      name: 'DAY 1',
      content:[
        banff1,
        banff2
      ]
    },
    {
      name: 'DAY 2',
      content:[
        banff3,
        banff4
      ]
    }
  ]
};
const initialTrips = {
  loading: false,
  trips: [asiaSETrip, banffTrip],
  error: ""
};

const reorderHelper = (trips, action) => {
  const src = action.payload.source, dest = action.payload.destination, tripID = action.payload.tripID;
  const trip = trips.trips.find(obj => obj._id === tripID);
  const copyList = trip.days[src.droppableId];
  const [removed] = copyList.content.splice(src.index, 1);
  copyList.content.splice(dest.index, 0, removed);
  const tripIndex = trips.trips.findIndex(obj => obj._id === tripID);
  trips.trips[tripIndex].days[src.droppableId] = copyList;
  return trips;
};
const moveHelper = (trips, action) => {
  const src = action.payload.source, dest = action.payload.destination, tripID = action.payload.tripID;
  const trip = trips.trips.find(obj => obj._id === tripID);
  const srcClone = trip.days[src.droppableId];
  const destClone = trip.days[dest.droppableId];

  const [removed] = srcClone.content.splice(src.index, 1);
  destClone.content.splice(dest.index, 0, removed);
  const tripIndex = trips.trips.findIndex(obj => obj._id === tripID);
  trips.trips[tripIndex].days[src.droppableId] = srcClone;
  trips.trips[tripIndex].days[dest.droppableId] = destClone;
  return trips
};
const deleteHelper = (trips, action) => {
  const tripID = action.payload.tripID, listIndex = action.payload.listIndex, cardID = action.payload.cardID;
  const trip = trips.trips.find(obj => obj._id === tripID);
  const list = trip.days[listIndex].content;
  const index = list.map(x => {
    return x.id;
  }).indexOf(cardID);
  list.splice(index, 1);
  const tripIndex = trips.trips.findIndex(obj => obj._id === tripID);
  trips.trips[tripIndex].days[listIndex].content = list;
  return trips;
};
const addCardsHelper = (trips, action) => {
  const tripID = action.payload.tripID, listIndex = action.payload.listIndex, selectedCards = action.payload.selectedCards;
  let trip = trips.trips.find(obj => obj._id === tripID);
  let list = trip.days[listIndex].content;
  let newList = list.concat(selectedCards);
  const tripIndex = trips.trips.findIndex(obj => obj._id === tripID);
  trips.trips[tripIndex].days[listIndex].content = newList;
  return trips;
};

const tripsState = (trips = initialTrips, action) => {
  switch (action.type) {
    case 'ADD_TRIP_REDUX':
    let newTrips = trips.trips;
    newTrips.unshift(action.payload);
    return {
      ...trips,
      loading: false,
      trips: newTrips,
      error: ''
    };
    case 'REORDER_CARD':
    return reorderHelper(trips, action);
    case 'MOVE_CARD':
    return moveHelper(trips, action);
    case 'DELETE_CARD':
    return deleteHelper(trips, action);
    case 'ADD_CARDS':
    return addCardsHelper(trips, action);
    default: return trips;
  };
};

export const tripsReducer = {
  trips: tripsState
};
